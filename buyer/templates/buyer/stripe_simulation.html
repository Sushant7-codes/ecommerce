{% extends 'base.html' %}
{% load static %}

{% block title %}Stripe Payment Simulation - SportsHub{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-gray-900 to-black py-8">
    <div class="max-w-2xl mx-auto px-4">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-white mb-4">üí≥ Stripe Payment Simulation</h1>
            <p class="text-gray-400">This is a simulated Stripe payment page for testing</p>
            {% if orders|length > 1 %}
            <p class="text-blue-400 mt-2">Multiple orders from different sellers will be processed together</p>
            {% endif %}
        </div>

        <div class="bg-gray-800 rounded-2xl p-6 border border-blue-500/20">
            <!-- Orders Info -->
            <div class="mb-6">
                <h2 class="text-2xl font-bold text-white mb-4">
                    {% if orders|length > 1 %}
                        {{ orders|length }} Orders Combined
                    {% else %}
                        Order #{{ orders.0.order_number }}
                    {% endif %}
                </h2>
                
                {% if orders|length > 1 %}
                <div class="bg-gray-700/50 rounded-lg p-4 mb-4">
                    <h3 class="text-white font-semibold mb-2">Orders from different sellers:</h3>
                    {% for order in orders %}
                    <div class="flex justify-between items-center py-2 border-b border-gray-600 last:border-b-0">
                        <span class="text-white">Order #{{ order.order_number }}</span>
                        <span class="text-green-400">${{ order.total_amount }}</span>
                        <span class="text-blue-400 text-sm">Seller: {{ order.seller.username }}</span>
                    </div>
                    {% endfor %}
                </div>
                {% endif %}
                
                <div class="bg-gray-700/50 rounded-lg p-4">
                    <p class="text-white"><strong>Total Amount:</strong> ${{ total_amount }}</p>
                    <p class="text-white"><strong>Email:</strong> {{ customer_email }}</p>
                    <p class="text-white"><strong>Total Items:</strong> 
                        {% if orders|length > 1 %}
                            {{ orders|length }} orders combined
                        {% else %}
                            {{ orders.0.items.count }} item(s)
                        {% endif %}
                    </p>
                </div>
            </div>

            <!-- Test Card Info -->
            <div class="mb-6 bg-yellow-900/20 border border-yellow-500/30 rounded-lg p-4">
                <h3 class="text-yellow-400 font-semibold mb-2">üß™ Test Card Information</h3>
                <div class="text-sm text-yellow-300 space-y-1">
                    <p><strong>Card Number:</strong> 4242 4242 4242 4242</p>
                    <p><strong>Expiry Date:</strong> 12/34</p>
                    <p><strong>CVC:</strong> 123</p>
                    <p><strong>ZIP:</strong> 12345</p>
                </div>
            </div>

            <!-- Payment Form -->
            <form method="POST" action="{% url 'buyer:stripe_payment_complete' orders.0.order_number %}">
                {% csrf_token %}
                <div class="space-y-4 mb-6">
                    <div>
                        <label class="block text-gray-400 text-sm font-medium mb-2">Card Number</label>
                        <input type="text" name="card_number" required 
                               class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-500 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-all"
                               placeholder="4242 4242 4242 4242"
                               value="4242 4242 4242 4242">
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-gray-400 text-sm font-medium mb-2">Expiry Date</label>
                            <input type="text" name="expiry" required 
                                   class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-500 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-all"
                                   placeholder="MM/YY"
                                   value="12/34">
                        </div>
                        <div>
                            <label class="block text-gray-400 text-sm font-medium mb-2">CVC</label>
                            <input type="text" name="cvc" required 
                                   class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-500 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-all"
                                   placeholder="123"
                                   value="123">
                        </div>
                    </div>
                </div>

                <!-- Payment Button -->
                <button type="submit" 
                        class="w-full bg-gradient-to-r from-green-600 to-emerald-500 text-white font-bold py-4 px-6 rounded-xl hover:from-green-700 hover:to-emerald-600 transform hover:scale-105 transition-all duration-300 flex items-center justify-center space-x-2">
                    <span>üí≥ Pay ${{ total_amount }}</span>
                </button>

                <p class="text-center text-gray-400 text-sm mt-4">
                    üîí This is a simulated payment page. No real payment will be processed.
                </p>
            </form>

            <!-- Cancel Button -->
            <div class="mt-4">
                <a href="{% url 'buyer:checkout_cancel' orders.0.order_number %}" 
                   class="w-full bg-gray-600 text-white font-bold py-3 px-6 rounded-xl hover:bg-gray-700 transition-all duration-300 flex items-center justify-center space-x-2">
                    <span>‚ùå Cancel Payment</span>
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}