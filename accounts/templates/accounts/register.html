{% extends 'base.html' %}

{% block sidebar %}
{% endblock %}

{% block header %}
{% endblock header %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-gray-900 to-gray-800 flex items-center justify-center p-4">

    <!-- Toast Errors -->
    <div class="toast toast-end toast-top z-50">
        {% for error in form.non_field_errors %}
        <div class="alert alert-error shadow-lg">
            <span class="font-semibold">{{ error }}</span>
        </div>
        {% endfor %}
    </div>

    <!-- Register Card -->
    <form method="post" enctype="multipart/form-data"
          class="w-full max-w-md bg-gray-800 rounded-2xl shadow-2xl p-8 space-y-6 border border-gray-700">
        {% csrf_token %}

        <!-- Header -->
        <div class="text-center">
            <h1 class="text-3xl font-bold text-white mb-2">Join SportsHub</h1>
            <p class="text-gray-400">Create your account to get started</p>
        </div>

        <!-- Role Selection - Fixed Display -->
        <div>
            <label class="block text-sm font-medium text-white mb-3">
                üéØ Account Type:
            </label>
            <div class="relative">
                <select name="role" required class="w-full p-3 border border-gray-600 rounded-lg bg-gray-700 text-white focus:border-blue-500 focus:ring-2 focus:ring-blue-500">
                    <option value="">-- Select Account Type --</option>
                    <option value="buyer">üõí I want to Buy (Customer)</option>
                    <option value="seller">üè™ I want to Sell (Vendor)</option>
                </select>
            </div>
            {% for error in form.role.errors %}
            <p class="text-red-400 text-sm mt-1">{{ error }}</p>
            {% endfor %}
        </div>

        <!-- Single Column Layout -->
        <div class="space-y-4">
            <!-- Username -->
            <div>
                <label class="block text-sm font-medium text-white mb-2">
                    üë§ Username
                </label>
                {{ form.username }}
                {% for error in form.username.errors %}
                <p class="text-red-400 text-sm mt-1">{{ error }}</p>
                {% endfor %}
            </div>

            <!-- Email -->
            <div>
                <label class="block text-sm font-medium text-white mb-2">
                    üìß Email
                </label>
                {{ form.email }}
                {% for error in form.email.errors %}
                <p class="text-red-400 text-sm mt-1">{{ error }}</p>
                {% endfor %}
            </div>

            <!-- Phone -->
            <div>
                <label class="block text-sm font-medium text-white mb-2">
                    üì± Phone Number
                </label>
                {{ form.phone_number }}
                {% for error in form.phone_number.errors %}
                <p class="text-red-400 text-sm mt-1">{{ error }}</p>
                {% endfor %}
            </div>

            <!-- Name -->
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-white mb-2">
                        First Name
                    </label>
                    {{ form.first_name }}
                    {% for error in form.first_name.errors %}
                    <p class="text-red-400 text-sm mt-1">{{ error }}</p>
                    {% endfor %}
                </div>
                <div>
                    <label class="block text-sm font-medium text-white mb-2">
                        Last Name
                    </label>
                    {{ form.last_name }}
                    {% for error in form.last_name.errors %}
                    <p class="text-red-400 text-sm mt-1">{{ error }}</p>
                    {% endfor %}
                </div>
            </div>

            <!-- Password with Eye Icon -->
            <div>
                <label class="block text-sm font-medium text-white mb-2">
                    üîí Password
                </label>
                <div class="relative">
                    <input type="password" name="password1" required 
                           class="w-full p-3 pr-10 border border-gray-600 rounded-lg bg-gray-700 text-white focus:border-blue-500 focus:ring-2 focus:ring-blue-500"
                           placeholder="Enter your password">
                    <button type="button" 
                            class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-white toggle-password">
                        üëÅÔ∏è
                    </button>
                </div>
                {% for error in form.password1.errors %}
                <p class="text-red-400 text-sm mt-1">{{ error }}</p>
                {% endfor %}
            </div>

            <!-- Confirm Password with Eye Icon -->
            <div>
                <label class="block text-sm font-medium text-white mb-2">
                    ‚úÖ Confirm Password
                </label>
                <div class="relative">
                    <input type="password" name="password2" required 
                           class="w-full p-3 pr-10 border border-gray-600 rounded-lg bg-gray-700 text-white focus:border-blue-500 focus:ring-2 focus:ring-blue-500"
                           placeholder="Confirm your password">
                    <button type="button" 
                            class="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-white toggle-password">
                        üëÅÔ∏è
                    </button>
                </div>
                {% for error in form.password2.errors %}
                <p class="text-red-400 text-sm mt-1">{{ error }}</p>
                {% endfor %}
            </div>

            <!-- Address -->
            <div>
                <label class="block text-sm font-medium text-white mb-2">
                    üè† Address
                </label>
                {{ form.address }}
                {% for error in form.address.errors %}
                <p class="text-red-400 text-sm mt-1">{{ error }}</p>
                {% endfor %}
            </div>

            <!-- Profile Picture -->
            <div>
                <label class="block text-sm font-medium text-white mb-2">
                    üñºÔ∏è Profile Picture
                </label>
                {{ form.profile_pic }}
                {% for error in form.profile_pic.errors %}
                <p class="text-red-400 text-sm mt-1">{{ error }}</p>
                {% endfor %}
            </div>
        </div>

        <!-- Submit Button -->
        <button type="submit" 
                class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition-colors duration-200 mt-6">
            üöÄ Create Account
        </button>

        <!-- Login Link -->
        <div class="text-center pt-4 border-t border-gray-700">
            <p class="text-gray-400 text-sm">
                Already have an account? 
                <a href="{% url 'accounts:retail_admin_login' %}" 
                   class="text-blue-400 font-semibold hover:text-blue-300 hover:underline transition-colors">
                    Sign In Here
                </a>
            </p>
        </div>
    </form>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Password toggle functionality
    const toggleButtons = document.querySelectorAll('.toggle-password');
    
    toggleButtons.forEach(button => {
        button.addEventListener('click', function() {
            const passwordInput = this.previousElementSibling;
            const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
            passwordInput.setAttribute('type', type);
            
            // Change eye icon
            this.textContent = type === 'password' ? 'üëÅÔ∏è' : 'üôà';
        });
    });

    // Set default role to buyer
    const roleSelect = document.querySelector('select[name="role"]');
    if (roleSelect && !roleSelect.value) {
        roleSelect.value = 'buyer';
    }
});
</script>

<style>
/* Custom dark theme styles */
select, input, textarea {
    width: 100%;
    padding: 0.75rem;
    border: 1px solid #4b5563;
    border-radius: 0.5rem;
    background-color: #374151;
    color: white;
    transition: all 0.15s ease-in-out;
}

select:focus, input:focus, textarea:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
    background-color: #4b5563;
}

select {
    appearance: none;
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%239ca3af' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
    background-position: right 0.5rem center;
    background-repeat: no-repeat;
    background-size: 1.5em 1.5em;
    padding-right: 2.5rem;
}

/* Placeholder color */
::placeholder {
    color: #9ca3af;
}

/* File input styling */
input[type="file"] {
    padding: 0.5rem;
    background-color: #374151;
    border: 1px solid #4b5563;
}

input[type="file"]::file-selector-button {
    background-color: #3b82f6;
    color: white;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 0.375rem;
    margin-right: 1rem;
    cursor: pointer;
    transition: background-color 0.15s ease-in-out;
}

input[type="file"]::file-selector-button:hover {
    background-color: #2563eb;
}

/* Button hover effects */
button:hover {
    transform: translateY(-1px);
}

/* Password toggle button */
.toggle-password {
    background: none;
    border: none;
    cursor: pointer;
    font-size: 1.1rem;
    transition: color 0.15s ease-in-out;
}
</style>
{% endblock %}